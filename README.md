# Docker-Guide
–ü–æ–≥—Ä—É–∂–∞–µ–º—Å—è –≤  –∫–æ—Ä–æ–±–∫—É –∏–∑ –∫–æ—Ä–æ–±–∫–∏

[[# üì¶ –û–±—Ä–∞–∑—ã –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã]]
[[#üñ•Ô∏è Docker vs –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã]]
[[# üß≠ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Docker: –∫–∞–∫ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç]]
[[# üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –û–°]]
[[# üß™ –ü—Ä–∞–∫—Ç–∏–∫–∞: –∑–∞–ø—É—Å–∫–∞–µ–º –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤—Ä—É—á–Ω—É—é]]
[[# üì¶ chroot –∏ pivot_root ‚Äî –∫–∞–∫ –∏–∑–æ–ª–∏—Ä—É—é—Ç —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É]]
[[# üìÇ OverlayFS ‚Äî –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–±—Ä–∞–∑—ã –∏ —Å–ª–æ–∏]]
[[#üåê Docker-—Å–µ—Ç–∏ –∫–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏]]
[[#üîç –ü—Ä–æ—Å–º–æ—Ç—Ä bridge-—Å–µ—Ç–∏ Docker –Ω–∞ —Ö–æ—Å—Ç–µ]]
[[#üîß –ï—â–µ —Å–µ—Ç–∏ –¥–ª—è —É–≥–ª—É–±–ª–µ–Ω–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è (–Ω–æ —ç—Ç–æ —Å–ª–æ–∂–Ω–æ, –ª—É—á—à–µ –Ω–µ –ª–µ–∑—å =) )]]
[[#üìé [–ë–æ–Ω—É—Å] –ê –∫–∞–∫ –Ω–∞—Å—á—ë—Ç LVM –≤ Docker?]]
[[#üß± Dockerfile –∏ –∞–Ω–∞—Ç–æ–º–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞]]
[[#ü™∂ –õ—ë–≥–∫–∏–µ –æ–±—Ä–∞–∑—ã –∏ –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ]]
[[#üõ† Dockerfile Best Practices]]
[[#üß± Multi-Stage Build]]
[[#üíª –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã Docker CLI]]
[[#üß© –ë–∞–∑–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Dockerfile (—Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏)]]
[[#üå° –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Docker]]
[[#üîß `ENV` vs `ARG` ‚Äî –≤ —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞?]]
[[#üß† ENV vs ARG ‚Äî –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ (–∫–æ–≥–¥–∞ –Ω–µ–º–Ω–æ–≥–æ –Ω–µ –≤ –ø–æ—Ç–æ–∫–µ)]]
[[#üìÇ COPY vs ADD ‚Äî –≤ —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞?]]
[[#üß† –ü–æ–≤–µ–¥–µ–Ω–∏–µ Docker –ø—Ä–∏ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ CMD –∏ ENTRYPOINT]]
## üì¶ –û–±—Ä–∞–∑—ã –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

### –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–±—Ä–∞–∑ (image)?
–û–±—Ä–∞–∑ ‚Äî —ç—Ç–æ **—à–∞–±–ª–æ–Ω** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –ú–æ–∂–Ω–æ –¥—É–º–∞—Ç—å –æ –Ω—ë–º –∫–∞–∫ –æ "—Å–Ω–∞–ø—à–æ—Ç–µ" —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:
- –û–° –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `python`, `node`)
- —Ç–≤–æ–π –∫–æ–¥, –∫–æ–Ω—Ñ–∏–≥–∏
- –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å (`CMD`, `ENTRYPOINT`)

–û–±—Ä–∞–∑—ã —Å—Ç—Ä–æ—è—Ç—Å—è —Å–ª–æ—è–º–∏ (–∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `Dockerfile` ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ª–æ–π), —á—Ç–æ –¥–∞—ë—Ç:
- –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
- –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ—ë–≤

üõ† **–ü—Ä–∏–º–µ—Ä**:
```dockerfile
FROM python:3.11-slim
COPY . /app
WORKDIR /app
RUN pip install -r requirements.txt
CMD ["python", "main.py"]
```

### –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (container)?
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî **–∑–∞–ø—É—â–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –æ–±—Ä–∞–∑–∞**. –û–Ω:
- –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç —Ö–æ—Å—Ç–∞ –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã —è–¥—Ä–∞ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—ã (—á–µ—Ä–µ–∑ cgroups, namespaces)
- —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ, –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

üß† –ê–Ω–∞–ª–æ–≥–∏—è:  
**–û–±—Ä–∞–∑ ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å**, –∞ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç**.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ
- `docker build` ‚Üí —Å–æ–∑–¥–∞—ë—Ç –æ–±—Ä–∞–∑
- `docker run` ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑ –æ–±—Ä–∞–∑–∞


---

## üñ•Ô∏è Docker vs –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã

|–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞|Docker|–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞|
|---|---|---|
|–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞|–°–µ–∫—É–Ω–¥—ã|–ú–∏–Ω—É—Ç—ã|
|–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å|–ü–æ—á—Ç–∏ –Ω–∞—Ç–∏–≤–Ω–∞—è|–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä|
|–ò–∑–æ–ª—è—Ü–∏—è|–ß–µ—Ä–µ–∑ namespaces/cgroups|–ß–µ—Ä–µ–∑ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä|
|–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤|–ú–µ–Ω—å—à–µ|–ë–æ–ª—å—à–µ (–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –û–°)|
|–û–±—Ä–∞–∑ —Å–∏—Å—Ç–µ–º—ã|–¢–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã|–ü–æ–ª–Ω–∞—è –û–°|

üß† **–ò—Ç–æ–≥**:

- Docker –ª—É—á—à–µ –¥–ª—è **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, CI/CD, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤**
    
- VM ‚Äî –¥–ª—è **–∂—ë—Å—Ç–∫–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ (—á–∏—Ç–∞–π –∫–∞–∫ —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏), legacy-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –º–æ–Ω–æ–ª–∏—Ç–æ–≤**

## üß≠ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Docker: –∫–∞–∫ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

–í–æ—Ç –±–∞–∑–æ–≤–∞—è —Å—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π ( —è –±—ã —Å—Ç—ã—Ä–∏–ª —É –ö–æ—Å—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É –Ω–æ –µ–µ –Ω–µ—Ç, –∞ —Å–Ω–∏–º–æ–∫ —ç–∫—Ä–∞–Ω–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç :) ) :

```
        [ Docker CLI ]
             |
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ  Docker Daemon ‚îÇ  ‚Üê —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Å–µ—Ä–≤–∏—Å –Ω–∞ Docker Host
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                      ‚îÇ
     ‚îÇ     Docker Host      ‚îÇ
     ‚îÇ                      ‚îÇ
     ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
     ‚îÇ  ‚îÇ   Images     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îò ‚Üê docker pull / build
     ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ       ‚îÇ
     ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ  ‚îÇContainer‚îÇ ‚Üê docker run
     ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
        [ Docker Registry ]
            (Docker Hub,
            GitHub CR,
            Private, –∏ —Ç.–¥.)
```

---

### üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **Docker CLI**  
  –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ö–æ–º–∞–Ω–¥—ã —Ç–∏–ø–∞ `docker build`, `docker run`, `docker pull`.

- **Docker Daemon (`dockerd`)**  
  –°–ª—É—à–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã CLI, —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–∑–∞–º–∏, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏, —Ç–æ–º–∞–º–∏, —Å–µ—Ç—è–º–∏.  
  –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ systemd-—Å–µ—Ä–≤–∏—Å –∏–ª–∏ –≤—Ä—É—á–Ω—É—é.

- **Docker Host**  
  –≠—Ç–æ –û–°, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç daemon –∏ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –æ–±—ã—á–Ω–æ Linux, WSL2 –∏–ª–∏ Mac —á–µ—Ä–µ–∑ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é.

- **Images (–æ–±—Ä–∞–∑—ã)**  
  –®–∞–±–ª–æ–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –°–æ—Å—Ç–æ—è—Ç –∏–∑ —Å–ª–æ—ë–≤.

- **Containers (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)**  
  –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∏–∑ –æ–±—Ä–∞–∑–∞. Docker –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ `containerd ‚Üí runc`.

- **Docker Registry**  
  –•—Ä–∞–Ω–∏–ª–∏—â–µ –æ–±—Ä–∞–∑–æ–≤. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî [Docker Hub](https://hub.docker.com), –Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
  - GitHub Container Registry
  - GitLab
  - Azure Container Registry
  - Nexus / Harbor (on-prem)

---

### üîÑ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

- `docker build .`  
  ‚Üí –°–æ–∑–¥–∞—ë—Ç –æ–±—Ä–∞–∑ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ

- `docker pull nginx`  
  ‚Üí –°–∫–∞—á–∏–≤–∞–µ—Ç –æ–±—Ä–∞–∑ –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî Docker Hub)

- `docker run nginx`  
  ‚Üí –°–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑ –æ–±—Ä–∞–∑–∞, –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤ –∏–∑–æ–ª—è—Ü–∏–∏

- `docker push myimage:tag`  
  ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–∑ –≤ —Ä–µ–µ—Å—Ç—Ä (–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∏ –µ—Å—Ç—å –ø—Ä–∞–≤–∞)

---

üß† –≠—Ç–∞ —Å—Ö–µ–º–∞ ‚Äî –±–∞–∑–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤—Å–µ—Ö –±—É–¥—É—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: —Å–µ—Ç–µ–π, —Ç–æ–º–æ–≤, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∏ –¥–∞–∂–µ CI/CD.

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –û–°

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî —ç—Ç–æ **–Ω–µ –º–∞–≥–∏—è, –Ω–µ –ª—ë–≥–∫–∞—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è**, –∞ –ø—Ä–æ—Å—Ç–æ **–ø—Ä–æ—Ü–µ—Å—Å**, –∫–æ—Ç–æ—Ä–æ–º—É –û–° –∂—ë—Å—Ç–∫–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç:
- —á—Ç–æ –æ–Ω **–≤–∏–¥–∏—Ç** (–∏–∑–æ–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ namespaces),
- —á–µ–º –æ–Ω **–º–æ–∂–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è** (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ cgroups).

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç **–Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞** –∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞.

---

### üß± Namespace ‚Äî –∏–∑–æ–ª—è—Ü–∏—è

`Namespaces` –∏–∑–æ–ª–∏—Ä—É—é—Ç **—Ä–µ—Å—É—Ä—Å—ã**, –∫–æ—Ç–æ—Ä—ã–µ –≤–∏–¥–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å:

| Namespace     | –ß—Ç–æ –∏–∑–æ–ª–∏—Ä—É–µ—Ç              | CLI —É—Ç–∏–ª–∏—Ç–∞      |
|---------------|----------------------------|------------------|
| `mnt`         | –¢–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è         | `mount`, `chroot` |
| `pid`         | –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤           | `ps`, `top`       |
| `net`         | –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã         | `ip`, `ifconfig`  |
| `uts`         | –ò–º—è —Ö–æ—Å—Ç–∞                  | `hostname`        |
| `ipc`         | IPC: —Å–µ–º–∞—Ñ–æ—Ä—ã, –æ—á–µ—Ä–µ–¥–∏     | `ipcs`            |
| `user`        | UID/GID (—Ä–∞–∑–Ω—ã–µ root‚Äô—ã)    | `id`, `whoami`    |
| `cgroup`      | –ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ—Å—É—Ä—Å–æ–≤          | ‚Äî                |

–ö–∞–∂–¥—ã–π `docker run` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –Ω–∞–±–æ—Ä namespaces, –¥–∞–≤–∞—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π "–º–∏—Ä".

---

### ‚öñÔ∏è Cgroups ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ—Å—É—Ä—Å–æ–≤

`Control Groups (cgroups)` –ø–æ–∑–≤–æ–ª—è—é—Ç **–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å**:
- CPU, RAM
- I/O
- –ö–æ–ª-–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Ö, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ "—Å—ä–µ–ª–∏" —Ö–æ—Å—Ç:

```bash
docker run --memory=512m --cpus=1 busybox
```

üí° –ù–∞ —Ö–æ—Å—Ç–µ –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å —á–µ—Ä–µ–∑:
```bash
cat /sys/fs/cgroup/
```

---

### üì¶ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ `docker run`

1. Docker Engine –≤—ã–∑—ã–≤–∞–µ—Ç **containerd**
2. `containerd` –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ `runc`
3. `runc` —Å–æ–∑–¥–∞—ë—Ç:
   - –Ω–æ–≤—ã–µ namespaces
   - –ø—Ä–∏–º–µ–Ω—è–µ—Ç cgroups
   - –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –≤–Ω—É—Ç—Ä–∏ `chroot` –∏–ª–∏ `pivot_root`

–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω –æ–¥–∏–Ω –Ω–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ ‚Äî —ç—Ç–æ –∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

---

### üîß –ß—Ç–æ —Ç–∞–∫–æ–µ runc?

`runc` ‚Äî —É—Ç–∏–ª–∏—Ç–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ [Open Container Initiative (OCI)](https://opencontainers.org/), –∑–∞–ø—É—Å–∫–∞—é—â–∞—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ Linux.  
Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `runc` –∫–∞–∫ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π runtime –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

–ú–æ–∂–µ—à—å –≤—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ `runc` –±–µ–∑ Docker ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è.

---

### üìò –ß—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å:

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚â† –õ—ë–≥–∫–∞—è VM: —É –Ω–∏—Ö **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ kernel**
- –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–¥–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ **–¥–µ–ª—è—Ç —è–¥—Ä–æ**, –Ω–æ –Ω–µ –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞
- Docker –ø—Ä–æ—Å—Ç–æ –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ Linux

---



## üß™ –ü—Ä–∞–∫—Ç–∏–∫–∞: –∑–∞–ø—É—Å–∫–∞–µ–º –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤—Ä—É—á–Ω—É—é

### üß∞ `unshare` ‚Äî —Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ namespace

–ö–æ–º–∞–Ω–¥–∞ `unshare` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞—Ç—å namespace –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ –Ω—ë–º –ø—Ä–æ—Ü–µ—Å—Å.

```bash
sudo unshare --fork --pid --mount-proc bash
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- `--pid`: —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π PID namespace
- `--mount-proc`: –º–æ–Ω—Ç–∏—Ä—É–µ—Ç `/proc` –∑–∞–Ω–æ–≤–æ, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã
- `--fork`: –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (bash)

–¢–µ–ø–µ—Ä—å –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ `bash`:
```bash
ps aux      # —Ç—ã —É–≤–∏–¥–∏—à—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å
```

üß† –≠—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–∫ —É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –Ω–æ –±–µ–∑ Docker.

---

### üîç –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ namespace –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

#### `lsns` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ namespace:
```bash
lsns
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
NS TYPE   PID  USER     COMMAND
4026531836 mnt 1   root     systemd
4026532449 net 2480 user     bash
...
```

#### `pstree -ns <PID>` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ + namespace info:
```bash
pstree -ns 2480
```

#### `nsenter` ‚Äî –≤–æ–π—Ç–∏ –≤ namespace –¥—Ä—É–≥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞:
```bash
sudo nsenter -t <PID> --mount --uts --ipc --net --pid
```

üí° –≠—Ç–æ –∫–∞–∫ "–≤–æ–π—Ç–∏ –≤–Ω—É—Ç—Ä—å" —á—É–∂–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞/–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.

---

## üì¶ chroot –∏ pivot_root ‚Äî –∫–∞–∫ –∏–∑–æ–ª–∏—Ä—É—é—Ç —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

### üîê chroot

`chroot` –º–µ–Ω—è–µ—Ç **–∫–æ—Ä–µ–Ω—å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã** –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞.

```bash
sudo chroot /myroot /bin/bash
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ `/` –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å—Ç–∞–Ω–µ—Ç `/myroot` –Ω–∞ —Ö–æ—Å—Ç–µ.

‚ö†Ô∏è `chroot` ‚Äî –ø—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ –∏–∑–æ–ª—è—Ü–∏–∏, **–Ω–µ –º–µ–Ω—è–µ—Ç namespace** –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å "–æ–±–æ–π–¥–µ–Ω–∞".

---

### üîÄ pivot_root

`pivot_root` ‚Äî –±–æ–ª–µ–µ –º–æ—â–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ `chroot`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

–ü–æ–∑–≤–æ–ª—è–µ—Ç:
- **–æ—Ç–¥–µ–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ—Ä–µ–Ω—å** –æ—Ç –Ω–æ–≤–æ–≥–æ
- –∑–∞–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π `/`, –∞ —Å—Ç–∞—Ä—É—é FS –≤—ã–Ω–µ—Å—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `/mnt/old_root`

–≠—Ç–æ –¥–∞—ë—Ç –ø–æ–ª–Ω—É—é –∏–∑–æ–ª—è—Ü–∏—é, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Å–≤—è–∑–∫–µ —Å `mount` namespace.

Docker —á–µ—Ä–µ–∑ `runc` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–º–µ–Ω–Ω–æ `pivot_root`.

---

## üìÇ OverlayFS ‚Äî –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–±—Ä–∞–∑—ã –∏ —Å–ª–æ–∏

Docker-–æ–±—Ä–∞–∑—ã —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Å–ª–æ—ë–≤. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OverlayFS:

```
LowerDir (read-only —Å–ª–æ–∏ –æ–±—Ä–∞–∑–∞)
UpperDir (—Å–ª–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
MergedDir (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è view)
```

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:

```bash
docker inspect <container_id> | grep MergedDir
```

–ü—Ä–∏–º–µ—Ä –¥–µ—Ä–µ–≤–∞:
```
/var/lib/docker/overlay2/<ID>/
  ‚îú‚îÄ‚îÄ diff/         ‚Üê UpperDir
  ‚îú‚îÄ‚îÄ merged/       ‚Üê —Ç–æ, —á—Ç–æ –≤–∏–¥–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  ‚îî‚îÄ‚îÄ lower/        ‚Üê —Å–ª–æ–∏ –æ–±—Ä–∞–∑–∞
```

üìå –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—Ä–∞–∑—ã
- –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

üí° –ù–µ —É–≥–ª—É–±–ª—è–π—Å—è –≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ OverlayFS, –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—Å—è—Ç ‚Äî –ª—É—á—à–µ –∑–Ω–∞—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω. (Middle+ to Senior)

---


## üåê Docker-—Å–µ—Ç–∏: –∫–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏

–í–æ—Ç —Å—Ö–µ–º–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –≤ Docker :

```
           [ Docker Host ]
                |
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ     bridge     ‚îÇ ‚Üê default-—Å–µ—Ç—å (docker0)
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                   ‚îÇ
 [Container A]    [Container B]
     ‚îÇ                   ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
          Docker DNS
         (–ø–æ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞)
```

---

### üì¶ –¢–∏–ø—ã Docker-—Å–µ—Ç–µ–π

1. **bridge** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –°–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Docker (`docker0`)
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —ç—Ç–æ–π —Å–µ—Ç–∏ –º–æ–≥—É—Ç **–æ–±—â–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π**
   - –ü–æ—Ä—Ç –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ **—Å–Ω–∞—Ä—É–∂–∏**

2. **host**
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ —Ö–æ—Å—Ç–∞**
   - –ù–µ—Ç –∏–∑–æ–ª—è—Ü–∏–∏ IP, –Ω–æ –ª—É—á—à–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
   - –ü—Ä–∏–º–µ—Ä: `docker run --network host`

3. **none**
   - –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–µ–Ω–∞ —Å–µ—Ç–µ–≤–∞—è –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, sandbox-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

4. **user-defined bridge**
   - –°–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä—É—á–Ω—É—é: `docker network create mynet`
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç **–∏–º–µ–Ω–∞ —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π DNS**
   - –õ—É—á—à–µ, —á–µ–º default `bridge`: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–º–µ–Ω–∞, —Å—Å—ã–ª–∫–∏, –∞–ª–∏–∞—Å—ã

---

### üîç –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞ —Ö–æ—Å—Ç–µ

#### Default-—Å–µ—Ç—å:
```bash
ip a | grep docker0
```

#### –°–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π:
```bash
docker network ls
```

#### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ç–∏:
```bash
docker network inspect bridge
```

---

### üß† –ö–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—â–∞—é—Ç—Å—è

- –í –æ–¥–Ω–æ–π —Å–µ—Ç–∏: `ping <–∏–º—è_–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞>` (–µ—Å–ª–∏ `user-defined`)
- –ß–µ—Ä–µ–∑ –ø–æ—Ä—Ç —Å–Ω–∞—Ä—É–∂–∏: `-p 8080:80` (host:container)
- –ß–µ—Ä–µ–∑ DNS –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏: Docker —Å–∞–º –ø–æ–¥–Ω–∏–º–∞–µ—Ç DNS-—Å–µ—Ä–≤–µ—Ä –≤ bridge

---

### üõ† –ü—Ä–∏–º–µ—Ä: user-defined —Å–µ—Ç—å

```bash
docker network create mynet
```

```bash
docker run -dit --name backend --network mynet busybox
docker run -dit --name frontend --network mynet busybox
```

–¢–µ–ø–µ—Ä—å –≤–Ω—É—Ç—Ä–∏ `frontend`:
```bash
ping backend  # —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

---

### üö™ –ü–æ—Ä—Ç-–º–∞–ø–ø–∏–Ω–≥

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø **—Å–Ω–∞—Ä—É–∂–∏**:

```bash
docker run -p 8080:80 nginx
```

- 8080 ‚Äî –ø–æ—Ä—Ç –Ω–∞ —Ö–æ—Å—Ç–µ
- 80 ‚Äî –ø–æ—Ä—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–Ω–æ –Ω–µ –ø—É—Å–∫–∞—Ç—å –Ω–∞—Ä—É–∂—É –≤–æ–æ–±—â–µ ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å–µ—Ç–∏.

---

### üìò Docker Compose –∏ —Å–µ—Ç–∏

Compose –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞—ë—Ç **–æ—Ç–¥–µ–ª—å–Ω—É—é user-defined bridge-—Å–µ—Ç—å**, –≤ –Ω–µ–π:
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ `service_name`
- –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞—â–µ–Ω–∏—è: `http://db:5432`

–ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å–≤–æ—é —Å–µ—Ç—å:
```yaml
networks:
  backend:
```

---

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å

- –ò—Å–ø–æ–ª—å–∑—É–π **—Ä–∞–∑–Ω—ã–µ —Å–µ—Ç–∏** –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞ –∏ –±–∞–∑—ã
- –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–π **—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã**
- Docker –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **firewall (iptables)** –∏ **network policies (–≤ Kubernetes)**

---

## üîç –ü—Ä–æ—Å–º–æ—Ç—Ä bridge-—Å–µ—Ç–∏ Docker –Ω–∞ —Ö–æ—Å—Ç–µ

–ö–æ–≥–¥–∞ Docker —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –æ–Ω —Å–æ–∑–¥–∞—ë—Ç **—Å–µ—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** `bridge`, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Linux-—Å–µ—Ç–µ–≤–æ–π –º–æ—Å—Ç (`docker0`).

---

### üì° –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ —Å–∏—Å—Ç–µ–º–µ

#### 1. `ip link` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
```bash
ip link show
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
3: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> ...
    link/ether 02:42:3a:f9:e4:8a brd ff:ff:ff:ff:ff:ff
```

‚Üí –≠—Ç–æ –∏ –µ—Å—Ç—å —Å–µ—Ç–µ–≤–æ–π –º–æ—Å—Ç `bridge`, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π Docker —Å–æ–µ–¥–∏–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.

---

#### 2. `brctl show` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –º–æ—Å—Ç—ã –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

```bash
sudo brctl show
```

–ü—Ä–∏–º–µ—Ä:
```
bridge name     bridge id               STP enabled     interfaces
docker0         8000.02423af9e48a       no              veth7b2f04a
                                                    ‚Ü≥ vethcc72a3c
```

- `docker0` ‚Äî —Å–∞–º –º–æ—Å—Ç
- `veth*` ‚Äî –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ Ethernet-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–µ–¥–∏–Ω—è—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –º–æ—Å—Ç–æ–º

üß† –ö–∞–∂–¥–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–∞—Ä–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤:
- –û–¥–∏–Ω –∫–æ–Ω–µ—Ü ‚Äî –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`eth0`)
- –í—Ç–æ—Ä–æ–π ‚Äî –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ `docker0` –Ω–∞ —Ö–æ—Å—Ç–µ (`vethXXXX`)

---

### üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -it --rm busybox sh
```

```bash
ip a
```

–ü—Ä–∏–º–µ—Ä:
```
eth0@if35: ...
inet 172.17.0.2/16
```

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–ª—É—á–∏–ª IP –∏–∑ –ø–æ–¥—Å–µ—Ç–∏ `docker0` (`172.17.0.0/16`)
- `@if35` ‚Äî –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ `eth0` —Å–≤—è–∑–∞–Ω —Å veth-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –Ω–∞ —Ö–æ—Å—Ç–µ

---

### üßµ –ö–∞–∫ –≤—Å—ë —ç—Ç–æ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è

```
[Container eth0] ‚Üî [vethXXXX] ‚Üî [docker0 bridge] ‚Üî [eth0 —Ö–æ—Å—Ç–∞] ‚Üî –í–Ω–µ—à–Ω—è—è —Å–µ—Ç—å
```

- –ú–æ—Å—Ç `docker0` –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ **—Å–≤–∏—Ç—á–∞** –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- –í—Å—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (iptables, NAT)

---

## üîß –ï—â–µ —Å–µ—Ç–∏ –¥–ª—è —É–≥–ª—É–±–ª–µ–Ω–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è (–Ω–æ —ç—Ç–æ —Å–ª–æ–∂–Ω–æ, –ª—É—á—à–µ –Ω–µ –ª–µ–∑—å =) )

|–°–µ—Ç—å|–ö–æ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω–∞|
|---|---|
|`bridge`|–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤|
|`overlay`|–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å **Docker Swarm** –∏–ª–∏ **Kubernetes**|
|`macvlan`|–ö–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –Ω—É–∂–µ–Ω **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π IP –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏**|
|`ipvlan`|–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ L2/L3 –∏–∑–æ–ª—è—Ü–∏–∏|
|`host`|–î–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–∫—Å–∏)|
|`none`|–î–ª—è —Ç–µ—Å—Ç–æ–≤, sandbox-–æ–∫—Ä—É–∂–µ–Ω–∏–π|

## üìé [–ë–æ–Ω—É—Å] –ê –∫–∞–∫ –Ω–∞—Å—á—ë—Ç LVM –≤ Docker?

Docker **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç LVM –Ω–∞–ø—Ä—è–º—É—é** –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.  
–ù–æ **LVM –º–æ–∂–µ—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å**, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω storage driver `devicemapper` –≤ —Ä–µ–∂–∏–º–µ `direct-lvm`.

### –ö–æ–≥–¥–∞ —ç—Ç–æ –º–æ–∂–µ—Ç –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è:
- –°—Ç–∞—Ä—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ CentOS/RHEL)
- –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å LVM-–ø—É–ª–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `devicemapper` –≤ —Ä–µ–∂–∏–º–µ `direct-lvm` ‚Äî **—Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ LVM**

### –ß—Ç–æ —Å—Ç–æ–∏—Ç –∑–Ω–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏:
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `overlay2`, –∏ LVM —Ç—É—Ç –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç
- `devicemapper` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 2 —Ä–µ–∂–∏–º–∞:
  - loop-lvm (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –º–µ–¥–ª–µ–Ω–Ω—ã–π)
  - direct-lvm (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π, —Ç—Ä–µ–±—É–µ—Ç LVM setup)
- LVM –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ —Ç–æ–º–∞–º–∏, –Ω–æ –≤ Docker —ç—Ç–æ **–∫—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–∞—è** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

üß† *–ï—Å–ª–∏ –≤–∞–º –∑–∞–¥–∞—é—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–æ LVM –∏ Docker ‚Äî —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –∏–Ω—Ç–µ—Ä–≤—å—é –Ω–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π DevOps/Storage Engineer —É—Ä–æ–≤–µ–Ω—å. –ù—É –∏–ª–∏ –æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ —Ç–æ–≥–æ —Å–∞–º–æ–≥–æ, –¥—Ä–æ–ø–∞–π—Ç–µ.*

## üß± Dockerfile –∏ –∞–Ω–∞—Ç–æ–º–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏–∑ –æ–±—Ä–∞–∑–∞.  
–ê **–æ–±—Ä–∞–∑ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Dockerfile**, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–ø–∏—Å–∞–Ω–æ:
- –ß—Ç–æ –ø–æ–ª–æ–∂–∏—Ç—å –≤–Ω—É—Ç—Ä—å (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ–¥, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
- –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ö–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω—É–∂–Ω—ã

---

### üî¨ –ò–∑ —á–µ–≥–æ —Å–æ—Å—Ç–æ–∏—Ç Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä = –ø—Ä–æ—Ü–µ—Å—Å + —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ + –∏–∑–æ–ª—è—Ü–∏—è

- **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞**  
  –°–ª–æ–∏ –∏–∑ Docker-–æ–±—Ä–∞–∑–∞ (–±–∞–∑–æ–≤—ã–π —Å–ª–æ–π + —Å–ª–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

- **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**  
  –°–µ—Ç–∏, PID, cgroups, mount, IPC namespaces

- **–ó–∞–ø—É—â–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**  
  –ò–º–µ–Ω–Ω–æ –æ–Ω "–∂–∏–≤—ë—Ç" –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (–≤ Dockerfile –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ CMD/ENTRYPOINT)

---

### üß≠ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Dockerfile (–∫–ª—é—á–µ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)

```Dockerfile
# 1. –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ (–Ω–∞—á–∞–ª–æ —Å–ª–æ—è)
FROM python:3.11-slim

# 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN pip install flask

# 3. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
COPY . /app

# 4. –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
WORKDIR /app

# 5. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
ENV FLASK_ENV=production

# 6. –ö–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
CMD ["python", "app.py"]
```

---

### üß† ENTRYPOINT vs CMD

- `CMD` ‚Äî –∫–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ **–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å**
- `ENTRYPOINT` ‚Äî **–æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞**, –∫–æ—Ç–æ—Ä—É—é **–Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é**, —Ç–æ–ª—å–∫–æ –∞—Ä–≥—É–º–µ–Ω—Ç—ã

üí° –ü—Ä–∏–º–µ—Ä:
```Dockerfile
ENTRYPOINT ["python"]
CMD ["app.py"]
```

‚Üí –ø—Ä–∏ `docker run myapp` –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–æ `python app.py`  
‚Üí –ø—Ä–∏ `docker run myapp test.py` –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–æ `python test.py`

---

### üßπ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

- –ò—Å–ø–æ–ª—å–∑—É–π `CMD` –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π `ENTRYPOINT + CMD` –¥–ª—è CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –í—Å–µ–≥–¥–∞ –∑–∞–¥–∞–≤–∞–π `WORKDIR`, —á—Ç–æ–±—ã –Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç base-–æ–±—Ä–∞–∑–∞
- –ò—Å–ø–æ–ª—å–∑—É–π `.dockerignore`, —á—Ç–æ–±—ã –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã

---

–•–æ—á–µ—à—å ‚Äî –¥–∞–ª—å—à–µ –∏–¥—ë–º –≤ Best Practices: `slim` –æ–±—Ä–∞–∑—ã, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ—ë–≤, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ `RUN`, `USER`, –∏ —Ç.–¥.?

---

## ü™∂ –õ—ë–≥–∫–∏–µ –æ–±—Ä–∞–∑—ã –∏ –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

–†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞ –≤–ª–∏—è–µ—Ç –Ω–∞:
- —Å–∫–æ—Ä–æ—Å—Ç—å —Å–±–æ—Ä–∫–∏ –∏ –¥–æ—Å—Ç–∞–≤–∫–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ CI/CD)
- –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –¥–∏—Å–∫–∞ –∏ —Å–µ—Ç–∏
- –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–º–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π = –º–µ–Ω—å—à–µ –∞—Ç–∞–∫)

### üì¶ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã

| –û–±—Ä–∞–∑              | –†–∞–∑–º–µ—Ä   | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                         |
|--------------------|----------|-------------------------------------|
| `ubuntu`, `debian` | ~20‚Äì30MB | –ü—Ä–∏–≤—ã—á–Ω—ã–π, —É–¥–æ–±–Ω—ã–π, –Ω–æ —Ç—è–∂—ë–ª—ã–π      |
| `alpine`           | ~5MB     | –°–≤–µ—Ä—Ö–ª—ë–≥–∫–∏–π, —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏   |
| `distroless`       | <10MB    | –ë–µ–∑ shell –∏ package manager –≤–æ–æ–±—â–µ  |
| `scratch`          | 0MB      | –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–æ–π, —Ç–æ–ª—å–∫–æ –¥–ª—è –±–∏–Ω–∞—Ä–µ–π |

---

### üß† –ß—Ç–æ —Ç–∞–∫–æ–µ `alpine`?

`Alpine Linux` ‚Äî –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è Linux-—Å–±–æ—Ä–∫–∞ (5 MB), –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:
- –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ Go, Rust, Python
- —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ –≤ multi-stage

```Dockerfile
FROM alpine
RUN apk add --no-cache curl
```

üìå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `musl` –≤–º–µ—Å—Ç–æ `glibc`, —á—Ç–æ –º–æ–∂–µ—Ç –ª–æ–º–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ Python/Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

<details>
<summary>‚ö†Ô∏è –ü–æ—á–µ–º—É Alpine –º–æ–∂–µ—Ç –ª–æ–º–∞—Ç—å Python/Java</summary>

### ‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ –ø—Ä–æ `alpine` –∏ `musl`

Alpine –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **`musl libc` –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π `glibc`** (GNU C Library), –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–ø–∏—Å–∞–Ω–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ Linux-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

#### –í —á—ë–º –ø—Ä–æ–±–ª–µ–º–∞:
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ Python/Java) **–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ `glibc`**
- `musl` –Ω–µ –Ω–∞ 100% —Å–æ–≤–º–µ—Å—Ç–∏–º —Å `glibc`
- –≠—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤–∏–¥–∞:
  ```
  ImportError: libc.so.6: version `GLIBC_2.28' not found
  ```

#### üìå –ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:

- `numpy`, `pandas`, `scipy`, `opencv`, `grpc`
- Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å native-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏
- Python —Å C/C++-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏

#### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:

1. –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Alpine, –µ—Å–ª–∏ —É —Ç–µ–±—è –Ω–∞—É—á–Ω—ã–π —Å—Ç–µ–∫ –∏–ª–∏ –Ω–∞—Ç–∏–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `glibc` –≤—Ä—É—á–Ω—É—é:
    ```Dockerfile
    RUN apk add --no-cache gcompat
    ```
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `python:3.11-slim` –≤–º–µ—Å—Ç–æ `alpine`

</details>

---

### üßº –ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--no-cache` –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–∞–∫–µ—Ç–æ–≤
- –£–¥–∞–ª—è—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –û–±—ä–µ–¥–∏–Ω—è—Ç—å `RUN`-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
  ```Dockerfile
  RUN apt-get update && apt-get install -y \
      curl \
      && apt-get clean && rm -rf /var/lib/apt/lists/*
  ```

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `multi-stage build` (–æ–± —ç—Ç–æ–º –¥–∞–ª–µ–µ)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–º–µ—Ä —á–µ—Ä–µ–∑:
  ```bash
  docker image ls
  ```

---

‚úÖ –¢–µ–ø–µ—Ä—å —Ç—ã –∑–Ω–∞–µ—à—å, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω Dockerfile –∏ –∫–∞–∫ —É–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ **–¥–µ–ª–∞—Ç—å –µ–≥–æ –ª–µ–≥—á–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ**.  


## üõ† Dockerfile: Best Practices

–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç:
- —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–æ–≤
- —É—Å–∫–æ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É
- —É–ª—É—á—à–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ø–æ–≤—ã—Å–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å

---

### ü™∂ 1. –ò—Å–ø–æ–ª—å–∑—É–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã

```Dockerfile
FROM python:3.11-slim   # –ª—É—á—à–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ python:3.11
```

üí° slim-–æ–±—Ä–∞–∑—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ, –±–µ–∑ dev-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.  
–ï—Å–ª–∏ –Ω—É–∂–µ–Ω ultra-light ‚Äî —Å–º–æ—Ç—Ä–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É `alpine`, –Ω–æ —Ç–µ—Å—Ç–∏—Ä—É–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

---

### üß± 2. –û–±—ä–µ–¥–∏–Ω—è–π RUN-–∫–æ–º–∞–Ω–¥—ã

–ö–∞–∂–¥–∞—è `RUN` ‚Äî —ç—Ç–æ –Ω–æ–≤—ã–π —Å–ª–æ–π. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä:

```Dockerfile
RUN apt-get update && apt-get install -y \
    curl \
 && rm -rf /var/lib/apt/lists/*
```

‚ö†Ô∏è –ù–µ –∑–∞–±—ã–≤–∞–π `apt-get clean` –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–µ—à–µ–π!

---

### üìÅ 3. –ò—Å–ø–æ–ª—å–∑—É–π .dockerignore

–§–∞–π–ª `.dockerignore` –ø–æ–º–æ–≥–∞–µ—Ç **–Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã**:

```
.git
__pycache__/
node_modules/
*.log
```

‚Üí —É—Å–∫–æ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É, —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä, –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —É—Ç–µ—á–µ–∫

---

### üßë‚Äç‚öïÔ∏è 4. –ù–µ —Ä–∞–±–æ—Ç–∞–π –æ—Ç root

```Dockerfile
RUN adduser --disabled-password myuser
USER myuser
```

‚Üí –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–∏—Å–∫–∏ –≤ —Å–ª—É—á–∞–µ –≤–∑–ª–æ–º–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

### üßº 5. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

–î–ª—è Python:
```Dockerfile
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
```

–î–ª—è Node.js:
```Dockerfile
COPY package*.json ./
RUN npm ci --only=production
```

‚Üí —ç—Ç–æ —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–±–æ—Ä–∫–∞–º–∏

---

### üß™ 6. –£–∫–∞–∑—ã–≤–∞–π WORKDIR

```Dockerfile
WORKDIR /app
COPY . .
```

‚Üí –Ω–µ –Ω—É–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–∏—Å–∞—Ç—å `cd /app && ...`

---

### üîÅ 7. Multi-stage build (–≤–≤–æ–¥–Ω–∞—è)

–°–Ω–∞—á–∞–ª–∞ –±–∏–ª–¥–∏–º, –ø–æ—Ç–æ–º –ø–µ—Ä–µ–Ω–æ—Å–∏–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ–µ:

```Dockerfile
FROM node:20 as build
WORKDIR /app
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=build /app/dist /usr/share/nginx/html
```

‚Üí —É–º–µ–Ω—å—à–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑, —É–±–∏—Ä–∞–µ—Ç dev-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

---

### üìç 8. –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

–ù–µ –ø–æ–ª–∞–≥–∞–π—Å—è –Ω–∞ `latest`:

```Dockerfile
FROM python:3.11.7-slim
```

‚Üí —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –æ–±—Ä–∞–∑–æ–≤

---

### üîê 9. –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π –∞—Ç–∞–∫—É—é—â—É—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å

- –£–¥–∞–ª—è–π `curl`, `gcc`, dev-–ø–∞–∫–µ—Ç—ã –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏
- –ù–µ –æ—Å—Ç–∞–≤–ª—è–π —Å–µ–∫—Ä–µ—Ç—ã –∏–ª–∏ `.env` –≤ –æ–±—Ä–∞–∑–µ
- –ò—Å–ø–æ–ª—å–∑—É–π `docker scan`, `trivy` –∏–ª–∏ `grype` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

---

### ‚úÖ 10. –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π —Å–≤–æ–π –æ–±—Ä–∞–∑ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
docker build -t myapp .
docker run -it --rm myapp
```

---


## üß± Multi-Stage Build

### üìå –ß—Ç–æ —ç—Ç–æ?

**Multi-stage build** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å–æ–±–∏—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤, —á—Ç–æ–±—ã:
- —Ä–∞–∑–¥–µ–ª–∏—Ç—å **build-time** –∏ **runtime**
- —É–º–µ–Ω—å—à–∏—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π –æ–±—Ä–∞–∑
- —É–±—Ä–∞—Ç—å dev-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Å–±–æ—Ä–æ—á–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã, –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –∏ —Ç.–¥.

---

### üß† –ü—Ä–∏–º–µ—Ä –±–µ–∑ multi-stage (–ø–ª–æ—Ö–æ–π —Å–ø–æ—Å–æ–±):

```Dockerfile
FROM node:20

WORKDIR /app
COPY . .
RUN npm install && npm run build

CMD ["npm", "start"]
```

üéí –í –∏—Ç–æ–≥–µ –≤ –æ–±—Ä–∞–∑ –ø–æ–ø–∞–¥—ë—Ç:
- `node_modules`, –≤–∫–ª—é—á–∞—è dev-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –∏—Å—Ö–æ–¥–Ω–∏–∫–∏, –±–∏–ª–¥-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- –∏ –≤—Å—ë, —á—Ç–æ –±—ã–ª–æ –≤ `COPY . .`

üì¶ –†–∞–∑–º–µ—Ä: ~600MB

---

### ‚úÖ –° multi-stage:

```Dockerfile
# –°—Ç–∞–¥–∏—è —Å–±–æ—Ä–∫–∏
FROM node:20 as builder

WORKDIR /app
COPY . .
RUN npm ci && npm run build

# –§–∏–Ω–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑
FROM nginx:alpine

COPY --from=builder /app/dist /usr/share/nginx/html
```

üîç –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- `builder` —Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –≤—Ç–æ—Ä–æ–π `FROM` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (`dist`)
- –∏—Ç–æ–≥–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å–æ–¥–µ—Ä–∂–∏—Ç **—Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏–∫—É + nginx**

üì¶ –†–∞–∑–º–µ—Ä: ~30MB (–ø—Ä–æ—Ç–∏–≤ 600MB –≤—ã—à–µ)

---

### üêç –ü—Ä–∏–º–µ—Ä multi-stage –¥–ª—è Python

```Dockerfile
# Stage 1 ‚Äî install deps
FROM python:3.11 as builder
WORKDIR /install
COPY requirements.txt .
RUN pip install --prefix=/install/deps -r requirements.txt

# Stage 2 ‚Äî copy deps + app
FROM python:3.11-slim
WORKDIR /app
COPY --from=builder /install/deps /usr/local
COPY . .
CMD ["python", "app.py"]
```

üí° –¢—É—Ç —Ç—ã:
- —Å—Ç–∞–≤–∏—à—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
- –Ω–µ –≤–∫–ª—é—á–∞–µ—à—å `pip`, `build tools`, `wheel` –∏ –ø—Ä. –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑

---

### üß± –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–¥–∏–∏:

- –ö–∞–∂–¥—ã–π `FROM` —Å–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤—ã–π –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π —ç—Ç–∞–ø**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `--from=<stage_name|index>` –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- –ú–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –¥–æ N —ç—Ç–∞–ø–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: base ‚Üí builder ‚Üí tester ‚Üí prod)

---

### ‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å multi-stage:

| –°—Ü–µ–Ω–∞—Ä–∏–π               | –ù—É–∂–Ω–æ multi-stage? |
|------------------------|--------------------|
| Node.js frontend       | ‚úÖ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ     |
| Python + –∫–æ–º–ø–∏–ª—è—Ü–∏—è C  | ‚úÖ –¥–∞              |
| Golang –±–∏–Ω–∞—Ä–Ω–∏–∫        | ‚úÖ –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç|
| Bash-—Å–∫—Ä–∏–ø—Ç –±–µ–∑ deps   | ‚ùå –∏–∑–±—ã—Ç–æ—á–Ω–æ       |
| Java —Å Maven/Gradle    | ‚úÖ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ     |

---

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —á–∏—Å—Ç–æ—Ç–∞

- –ù–µ –∫–æ–ø–∏—Ä—É–π `.ssh`, `.env`, `secrets` –Ω–∞ —Å—Ç–∞–¥–∏—é –±–∏–ª–¥–∞ ‚Äî Docker –∫—ç—à–∏—Ä—É–µ—Ç –≤—Å—ë
- –ò—Å–ø–æ–ª—å–∑—É–π `.dockerignore` –∏ **COPY only what's needed**
- –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã:  
  ```Dockerfile
  COPY dist /app  # –ª—É—á—à–µ, —á–µ–º COPY . .
  ```

---



## üíª –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã Docker CLI

---

### üì¶ –†–∞–±–æ—Ç–∞ —Å –æ–±—Ä–∞–∑–∞–º–∏ (Images)

```bash
docker pull nginx              # —Å–∫–∞—á–∞—Ç—å –æ–±—Ä–∞–∑ —Å Docker Hub
docker build -t myapp .       # —Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ –∏–∑ Dockerfile
docker images                 # —Å–ø–∏—Å–æ–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker rmi myapp              # —É–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–∑
docker tag                    # –∑–∞–¥–∞—Ç—å —Ç—ç–≥ –¥–ª—è –æ–±—Ä–∞–∑–∞ 
```

---

### üöÄ –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ (Containers)

```bash
docker run -it ubuntu bash    # –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
docker run -d -p 8080:80 nginx # –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ñ–æ–Ω–µ –∏ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—Ç

docker ps                     # –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker ps -a                  # –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–≤–∫–ª—é—á–∞—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)
docker stop <id|name>         # –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker rm <id|name>           # —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```

---

### üîç –ò–Ω—Å–ø–µ–∫—Ü–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∞

```bash
docker logs <id|name>         # –ø–æ–∫–∞–∑–∞—Ç—å stdout/stderr –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker exec -it <id|name> sh  # –∑–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker inspect <id|name>      # –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ/–æ–±—Ä–∞–∑–µ
```

---

### üßπ –ß–∏—Å—Ç–∫–∞

```bash
docker rm $(docker ps -aq)              # —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker rmi $(docker images -q)          # —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã
docker system prune -a                  # —É–¥–∞–ª–∏—Ç—å –≤—Å—ë –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ
```

‚ö†Ô∏è `system prune -a` ‚Äî –æ–ø–∞—Å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞, —É–¥–∞–ª—è–µ—Ç –í–°–Å –∫—Ä–æ–º–µ —Ç–µ–∫—É—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ.

---

### üõ† –ü—Ä–∏–º–µ—Ä—ã

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å Python —Å–∫—Ä–∏–ø—Ç:**
```bash
docker run --rm -v $(pwd):/app -w /app python:3.11 python script.py
```

2. **–°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–∑:**
```bash
docker build -t mybackend .
docker run -d -p 8000:8000 mybackend
```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞:**
```bash
docker image ls
```

---

### üß† –ü–æ–ª–µ–∑–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å:

- `-d` ‚Äî detached (–≤ —Ñ–æ–Ω–µ)
- `-it` ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ (stdin + TTY)
- `--rm` ‚Äî —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞
- `-v` ‚Äî volume (–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–æ–∫)
- `-e` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

---


## üß© –ë–∞–∑–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Dockerfile (—Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏)

---

### üìÅ `WORKDIR` ‚Äî —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

```Dockerfile
WORKDIR /app
```

- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç "—Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É", –≥–¥–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã (`RUN`, `COPY`, `CMD`, –∏ —Ç.–¥.)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –ø–∞–ø–∫—É, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ `WORKDIR`:
  ```Dockerfile
  WORKDIR /app
  WORKDIR /app/static
  ```

‚úÖ **–õ—É—á—à–µ, —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `cd` –≤ `RUN`-–∫–æ–º–∞–Ω–¥–∞—Ö**

---

### üë§ `USER` ‚Äî –ø–æ–¥ –∫–µ–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å

```Dockerfile
USER myuser
```

- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, **–æ—Ç –∫–∞–∫–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–∞ `CMD`/`ENTRYPOINT`
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Docker –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç `root` ‚Äî —ç—Ç–æ **–æ–ø–∞—Å–Ω–æ**!

---

### ‚ö†Ô∏è –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:

- –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ = –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ (–µ—Å–ª–∏ root)
- –•–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî **—Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –∏ —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç –Ω–µ–≥–æ

---

### üõ† –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ Dockerfile:

```Dockerfile
FROM python:3.11-slim

# —Å–æ–∑–¥–∞—ë–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
RUN useradd --create-home appuser

# –∑–∞–¥–∞—ë–º —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ –∫–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã
WORKDIR /home/appuser
COPY . .

# –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
USER appuser

CMD ["python", "app.py"]
```

---

üìå –ß—Ç–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å:
- –ï—Å–ª–∏ –æ–±—Ä–∞–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ Alpine:
  ```Dockerfile
  RUN adduser -D appuser
  ```
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–∑—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä `nginx`, `postgres`) —É–∂–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞–ø—Ä–∏–º–µ—Ä `nginx`, `postgres`

---

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π `USER`, —á—Ç–æ–±—ã:
- –∏–∑–±–µ–∂–∞—Ç—å root-–¥–æ—Å—Ç—É–ø–∞
- –ø–æ–≤—ã—Å–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º –∫ Kubernetes/CI-—Å—Ä–µ–¥–∞–º, –≥–¥–µ —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ª–∏–Ω—Ç–µ—Ä–∞–º–∏ –∏ DevSecOps

---

üß† –ú–æ–∂–Ω–æ –µ—â—ë –¥–æ–±–∞–≤–∏—Ç—å:
- `USER` —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ Dockerfile, –Ω–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:  
  ```bash
  docker run --user appuser myapp
  ```


---

### üèÅ `CMD` vs `ENTRYPOINT` ‚Äî —á—Ç–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

#### `CMD` ‚Äî –∫–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```Dockerfile
CMD ["python", "app.py"]
```

- –ú–æ–∂–Ω–æ **–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å** –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
  ```bash
  docker run myapp python test.py
  ```

---

#### `ENTRYPOINT` ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞

```Dockerfile
ENTRYPOINT ["python"]
CMD ["app.py"]
```

‚Üí –≠—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å `python app.py`  
‚Üí –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç: `docker run myapp test.py` ‚Üí –±—É–¥–µ—Ç `python test.py`

---

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

| –°—Ü–µ–Ω–∞—Ä–∏–π             | –ò—Å–ø–æ–ª—å–∑—É–π           |
|----------------------|---------------------|
| –ì–∏–±–∫–∏–π –∑–∞–ø—É—Å–∫         | `CMD`               |
| CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç / —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å | `ENTRYPOINT` + `CMD` |

üìå –•–æ—á–µ—à—å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π **–æ–±—ë—Ä—Ç–æ—á–Ω—ã–π shell-—Å–∫—Ä–∏–ø—Ç** + `ENTRYPOINT`

---

### üì§ `EXPOSE` ‚Äî –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—ã

```Dockerfile
EXPOSE 8080
```

- –ü—Ä–æ—Å—Ç–æ **–¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è**: –∫–∞–∫–æ–π –ø–æ—Ä—Ç –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç —Å–Ω–∞—Ä—É–∂–∏! –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–µ–Ω `-p 8080:8080`
- –ü–æ–ª–µ–∑–Ω–æ –≤ Compose –∏ –∞–≤—Ç–æ-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

### üì¶ `VOLUME` ‚Äî –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–æ–≤

```Dockerfile
VOLUME /data
```

- –ü–æ–º–µ—á–∞–µ—Ç –ø—É—Ç—å –∫–∞–∫ **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**
- Docker –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç—É–¥–∞ –¥–∞–Ω–Ω—ã–µ –≤–Ω–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, –∫—ç—à–µ–π –∏ —Ç.–ø.

üìå –¢–æ–º –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**, –µ—Å–ª–∏ –Ω–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤—Ä—É—á–Ω—É—é

---

### ‚ù§Ô∏è‚Äçü©π `HEALTHCHECK` ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```Dockerfile
HEALTHCHECK --interval=30s --timeout=5s \
  CMD curl -f http://localhost:8080/health || exit 1
```

- –ü–æ–∑–≤–æ–ª—è–µ—Ç Docker –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –°—Ç–∞—Ç—É—Å –≤–∏–¥–µ–Ω —á–µ—Ä–µ–∑ `docker ps` –∏–ª–∏ –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞—Ö (Swarm, K8s)
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏, —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

---

### ‚ú® –†–µ–∑—é–º–µ:

| –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è    | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  |
| ------------- | ------------------------------------------- |
| `WORKDIR`     | –ó–∞–¥–∞—Ç—å —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `CMD`         | –ö–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é                        |
| `ENTRYPOINT`  | –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è)      |
| `EXPOSE`      | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç, –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –µ–≥–æ        |
| `VOLUME`      | –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–Ω–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞              |
| `HEALTHCHECK` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏        |
| `USER`        | –ó–∞–¥–∞–µ–º —é–∑–≤–µ—Ä—è –∏ –ø–æ–≤—ã—à–∞–µ–º —Å–µ—Å—É—Ä–∏—Ç–∏           |

## üå° –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Docker

---

### üìå –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ?

- –ú–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏
- –•—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–µ–∫—Ä–µ—Ç—ã (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ)
- –†–∞–∑–¥–µ–ª—è—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏—è: `dev`, `stage`, `prod`

---

## üîß `ENV` vs `ARG` ‚Äî –≤ —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞?

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞         | `ARG`                   | `ENV`                   |
|------------------------|--------------------------|--------------------------|
| –î–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ build-time | ‚úÖ                       | ‚úÖ                       |
| –î–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ run-time   | ‚ùå (—Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è build) | ‚úÖ                       |
| –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å   | –ø—Ä–∏ `docker build`       | –ø—Ä–∏ `docker run` –∏–ª–∏ –≤ Compose |
| –ü–æ–ø–∞–¥–∞–µ—Ç –≤ –æ–±—Ä–∞–∑       | ‚ùå (–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)      | ‚úÖ (–≤–∏–¥–µ–Ω –≤ `docker inspect`) |

---

### üì• –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### `ARG` ‚Äî build-time –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:
```Dockerfile
ARG VERSION=1.0
FROM myapp:${VERSION}
```

–°–±–æ—Ä–∫–∞ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º:
```bash
docker build --build-arg VERSION=2.0 -t myapp:2.0 .
```

---

#### `ENV` ‚Äî runtime –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:

```Dockerfile
ENV APP_ENV=production
```

–ò–ª–∏ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
```bash
docker run -e APP_ENV=dev myapp
```

---

### üìÑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `.env` —Ñ–∞–π–ª–∞

–ü—Ä–∏–º–µ—Ä `.env`:
```
POSTGRES_USER=admin
POSTGRES_PASSWORD=secret
```

#### –í `docker-compose.yml`:
```yaml
version: '3'
services:
  db:
    image: postgres
    env_file:
      - .env
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `docker-compose.yml`:
```yaml
  ports:
    - "${PORT:-5432}:5432"
```

üí° `:-` ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∑–∞–¥–∞–Ω–∞

---

### üß± ENV + CMD –≤ Dockerfile

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ENV-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `CMD`:
```Dockerfile
ENV PORT=5000
CMD ["python", "app.py", "--port", "$PORT"]
```

‚ö†Ô∏è –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ **shell-—Ñ–æ—Ä–º–µ**:

```Dockerfile
CMD python app.py --port $PORT
```

–ò–ª–∏ —á–µ—Ä–µ–∑ wrapper script + `ENTRYPOINT`

---

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–µ —Ö—Ä–∞–Ω–∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ Dockerfile –∏–ª–∏ `.env`**
- –ò—Å–ø–æ–ª—å–∑—É–π **Docker secrets**, –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å Swarm –∏–ª–∏ K8s
- –ù–µ –∫–æ–º–º–∏—Ç—å `.env` –≤ Git

---

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

```bash
docker inspect <container_id>
```

–ò—â–∏ `"Env": [ ... ]`

---

## üß† ENV vs ARG ‚Äî –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ (–∫–æ–≥–¥–∞ –Ω–µ–º–Ω–æ–≥–æ –Ω–µ –≤ –ø–æ—Ç–æ–∫–µ)

---

### ü§î –í —á—ë–º —Å—É—Ç—å?

- **`ARG`** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞**
- **`ENV`** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç **–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**, —É–∂–µ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

---

### üß™ –ü—Ä–∏–º–µ—Ä –∏–∑ –∂–∏–∑–Ω–∏

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —Ç—ã –≥–æ—Ç–æ–≤–∏—à—å –±–æ—Ä—â:

- `ARG` ‚Äî —ç—Ç–æ **—Ä–µ—Ü–µ–ø—Ç** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≤–æ–∑—å–º–∏ 2 –∫–∞—Ä—Ç–æ—à–∫–∏")  
  üîπ –¢—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –µ–≥–æ —Ç–æ–ª—å–∫–æ **–≤–æ –≤—Ä–µ–º—è –≥–æ—Ç–æ–≤–∫–∏**

- `ENV` ‚Äî —ç—Ç–æ **—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–¥–∞—á–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–æ–¥–∞–≤–∞—Ç—å –≥–æ—Ä—è—á–∏–º")  
  üîπ –≠—Ç–æ –≤–ª–∏—è–µ—Ç —É–∂–µ **–∫–æ–≥–¥–∞ –±–æ—Ä—â –≥–æ—Ç–æ–≤** –∏ –ø–æ–¥–∞—ë—Ç—Å—è –Ω–∞ —Å—Ç–æ–ª

---

### üóÇ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ARG`

- –•–æ—á–µ—à—å **—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å —Ä–∞–∑–Ω—ã–º–∏ –±–∞–∑–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**
- –£–∫–∞–∑—ã–≤–∞–µ—à—å –≤–µ—Ä—Å–∏—é Python/Node, –æ–ø—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ –∏ —Ç.–ø.

```Dockerfile
ARG PYTHON_VERSION=3.11
FROM python:${PYTHON_VERSION}
```

```bash
docker build --build-arg PYTHON_VERSION=3.10 .
```

‚ö†Ô∏è –ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ `ARG` –∏—Å—á–µ–∑–∞–µ—Ç ‚Äî –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –µ–≥–æ —É–∂–µ –Ω–µ –±—É–¥–µ—Ç.

---

### üóÇ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ENV`

- –•–æ—á–µ—à—å **–º–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –∑–∞–ø—É—Å–∫–µ**
- –ü–µ—Ä–µ–¥–∞—ë—à—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ç.–¥.

```Dockerfile
ENV APP_ENV=production
```

```bash
docker run -e APP_ENV=dev myapp
```

üìå –≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±—É–¥—É—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ `ENV` (–º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á–µ—Ä–µ–∑ `printenv` –∏–ª–∏ `echo $APP_ENV`).

---

### üîÅ –ò—Ö –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å:

```Dockerfile
ARG VERSION
ENV APP_VERSION=$VERSION
```

‚Üí —Ç—ã –∑–∞–¥–∞—ë—à—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ, –∞ –ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –µ–≥–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

---

### ‚úÖ –ö—Ä–∞—Ç–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ:

| –í–æ–ø—Ä–æ—Å                                      | –ò—Å–ø–æ–ª—å–∑—É–π |
|--------------------------------------------|-----------|
| –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ **–≤–æ –≤—Ä–µ–º—è build** | `ARG`     |
| –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ **–≤–æ –≤—Ä–µ–º—è run** | `ENV`     |

---
## üìÇ COPY vs ADD ‚Äî –≤ —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞?

---

### üëØ –û–±–∞ –∫–æ–ø–∏—Ä—É—é—Ç —Ñ–∞–π–ª—ã –≤–Ω—É—Ç—Ä—å –æ–±—Ä–∞–∑–∞:

```Dockerfile
COPY ./src /app/src
ADD ./src /app/src
```

‚úÖ –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç **–±—É–¥–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π**

---

### ü§® –¢–∞–∫ –∑–∞—á–µ–º —Ç–æ–≥–¥–∞ –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö?

| –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å            | `COPY` ‚úÖ        | `ADD` ‚ö†Ô∏è                   |
|------------------------|------------------|----------------------------|
| –ö–æ–ø–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã | ‚úÖ               | ‚úÖ                         |
| –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç `.tar.gz` | ‚ùå               | ‚úÖ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏           |
| –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ URL        | ‚ùå               | ‚úÖ                         |
| –ü—Ä–æ–∑—Ä–∞—á–Ω–æ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ | ‚úÖ               | ‚ùå (–∏–Ω–æ–≥–¥–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ) |

---

### ‚ö†Ô∏è –ü–æ—á–µ–º—É `ADD` —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–ª–æ—Ö–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π?

1. **–ú–∞–≥–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** ‚Äî `.tar.gz` –±—É–¥–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω**, –¥–∞–∂–µ –µ—Å–ª–∏ —Ç—ã —ç—Ç–æ–≥–æ –Ω–µ —Ö–æ—á–µ—à—å
2. **–ù–µ—è–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** ‚Äî `ADD` –º–æ–∂–µ—Ç —Ç—è–Ω—É—Ç—å —Ñ–∞–π–ª—ã –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (`ADD https://...`), –∏ —ç—Ç–æ –ø–ª–æ—Ö–æ –¥–ª—è:
   - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
   - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. **COPY –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ, –Ω–æ –ø—Ä–æ—â–µ** ‚Äî –∏ **–≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ**

---

### ‚úÖ –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ADD`?

–¢–æ–ª—å–∫–æ –≤ —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ **–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ**:
- —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å `.tar.gz` –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –ø–æ URL (—Ö–æ—Ç—è –ª—É—á—à–µ `curl` –∏–ª–∏ `wget`)

---

### üß™ –ü—Ä–∏–º–µ—Ä—ã:

```Dockerfile
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤
COPY . /app

# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞ (–µ—Å–ª–∏ —Ç–æ—á–Ω–æ —É–≤–µ—Ä–µ–Ω)
ADD assets.tar.gz /var/www/html
```

---

### üìå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

> **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `COPY`, –µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å –∑–∞—á–µ–º —Ç–µ–±–µ `ADD`**  
> –≠—Ç–æ best practice, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è —Å–∞–º–∏–º Docker [–≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#add-or-copy)

---


## üß† –ü–æ–≤–µ–¥–µ–Ω–∏–µ Docker –ø—Ä–∏ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ CMD –∏ ENTRYPOINT

–í–æ—Ç –∫–∞–∫ Docker –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, **—á—Ç–æ –∏–º–µ–Ω–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è**, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, **–µ—Å—Ç—å –ª–∏ ENTRYPOINT –∏ CMD, –∏ –≤ –∫–∞–∫–æ–º –æ–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–µ**.

```
                    +---------------------------------------------+
                    |                  CMD                       |
                    |---------------------------------------------|
                    | –ë–µ–∑ CMD       | CMD ["exec_cmd", "arg"]   | CMD exec_cmd arg |
+-------------------+---------------+----------------------------+------------------+
|                   |               |                            |                  |
| –ë–µ–∑ ENTRYPOINT    | ‚ùå –û—à–∏–±–∫–∞      | ‚úÖ exec_cmd arg            | ‚úÖ shell exec     |
|                   | (–Ω–µ—Ç –∫–æ–º–∞–Ω–¥—ã) | (–∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å)     | (—á–µ—Ä–µ–∑ sh -c)    |
|-------------------+---------------+----------------------------+------------------|
| ENTRYPOINT exec   | ‚úÖ exec_entry  | ‚úÖ exec_entry exec_cmd arg | ‚úÖ exec_entry + sh|
| (shell-—Ñ–æ—Ä–º–∞)     |               | (–≤—Å—ë –∫–∞–∫ 1 –∞—Ä–≥—É–º–µ–Ω—Ç shell) | (–Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ) |
|-------------------+---------------+----------------------------+------------------|
| ENTRYPOINT ["exec_entry", "arg"]  (exec-—Ñ–æ—Ä–º–∞, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)                      |
|                   | ‚úÖ exec_entry arg     | ‚úÖ exec_entry exec_cmd arg     | ‚úÖ exec_entry exec_cmd arg     |
+-------------------+------------------------+-------------------------------+-------------------------------+
```

---

### üß™ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

#### ‚úÖ Exec-—Ñ–æ—Ä–º–∞ (–≤ `[]`) ‚Äî **–≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ**

```Dockerfile
ENTRYPOINT ["mybin"]
CMD ["arg1"]
# ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è: mybin arg1
```

#### ‚ö†Ô∏è Shell-—Ñ–æ—Ä–º–∞ ‚Äî Docker –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –≤ `/bin/sh -c`

```Dockerfile
ENTRYPOINT mybin
CMD arg1
# ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è: /bin/sh -c 'mybin arg1'
```

–≠—Ç–æ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Å–∏–≥–Ω–∞–ª—ã, PID 1, `docker stop`, –∏ —Ç.–ø.

---

### üìå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

| –î–µ–ª–∞–π                          | –ù–µ –¥–µ–ª–∞–π                          |
|-------------------------------|-----------------------------------|
| ENTRYPOINT –≤ exec-—Ñ–æ—Ä–º–µ (`[]`) | shell-—Ñ–æ—Ä–º—É –±–µ–∑ –Ω—É–∂–¥—ã            |
| CMD ‚Äî –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –∞—Ä–≥—É–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ shell –ø—Ä–∏ ENTRYPOINT |
| –û–±–æ—Ä–∞—á–∏–≤–∞–π —Å–ª–æ–∂–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã     | –Ω–µ –ø–∏—à–∏ –≤—Å—ë –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É        |

---

üß† **–õ–∞–π—Ñ—Ö–∞–∫ –¥–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è:**
> "Docker —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç ENTRYPOINT, –ø–æ—Ç–æ–º –¥–æ–±–∞–≤–ª—è–µ—Ç CMD –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.  
–ï—Å–ª–∏ ENTRYPOINT –Ω–µ –∑–∞–¥–∞–Ω ‚Äî CMD —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø–æ–ª–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π."

